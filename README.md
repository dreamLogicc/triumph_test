# Тестовое задание ГК "Триумф"

## SOTA 

1. TF-IDF + Cosine Similarity 
2. Pre-Trained models + Cosine Similarity
3. Siamese Networks

### TF-IDF + Cosine Similarity 

1. Предобработка текста (приведени к нижнему регистру, лемматизация, удаление стоп слов и тд.)
2. Вычисление TF-IDF (например в sklearn)
3. Вычисление косинусного сходства
4. Устанавливаем порог  (например, 0.8)
5. Если сходство > порога, считаем товары дубликатами

Преимущества:
- Простота реализации

- Быстро работает на малых и средних данных

- Хорошо справляется с очевидными дубликатами (одинаковые или очень похожие слова)

Недостатки:
- Не распознаёт синонимы (например, "телефон" != "смартфон")

- Зависит от точной формы слов 

- Не учитывает семантический смысл

- Уязвим к опечаткам и разному порядку слов

- Сильно зависит от качества предобработки

### Pre-Trained models + Cosine Similarity 

#### Text Embeddings + Cosine Similarity 

1. Предобработка текста (опционально)
2. С помощью модели (например из sentence_transformers) преобразуем тексты в эмбеддинги
3. Считаеми попарные расстояния между векторами
4. Устанавливаем порог  (например, 0.8)
5. Если сходство > порога, считаем товары дубликатами

Преимущества:

- Распознаёт синонимы, переформулировки, даже разный порядок слов
- Эмбеддинги можно рассчитать заранее и сравнивать быстро (например воспользоваться векторной БД)

Недостатки:

- Требует вычислительных ресурсов
- В специфических случаях требуется дообучение модели

Такой подход напрвлен только на работу с текстовыми атрибутами товара, но как показывает практика, у товара есть изображение и это тоже можно учесть.

#### Text Embeddings + Image Embeddings + Cosine Similarity 

1. Предобработка текста (опционально)
2. С помощью модели (например из sentence_transformers) преобразуем тексты в эмбеддинги
3. Выделяем признаки из изображений (например ResNet предобученный на ImageNet и др.) и получаем эмбеддинги изображения
4. Конкатенируем эмбеддинги текста и изображения
3. Считаеми попарные расстояния между векторами
4. Устанавливаем порог  (например, 0.8)
5. Если сходство > порога, считаем товары дубликатами

Преимущества:

Сохраняются преимущества предыдущего подхода, но к ним теперь добавляется учет дополнительной информации в виде изображения.

Недостатки: 

В связи с добавлением еще одной модели, потребуется еще больше вычислительных мощностей.

## Реализация
Было решено реализовать подход основанный на применении предобученной модели с последующим измерением косинусного расстояния.

- Файл `model.py` содержит класс реализующий создание эмбеддингов и поиск дбликатов для данного товара
- Файл `db.py` содержит словарь с товарами
- Файл `main.py` это entry point программы 

### Инструкция по запуску
1. Клонируйте репозиторий 
    ```bash 
   git clone https://github.com/dreamLogicc/triumph_test.git
    ```
2. Установите зависимости
    ```bash
    pip install -r requirements.txt
   ```
3. Запустите
    ```bash
    python main.py
   ```
P.S. Все названия и описания товаров были взяты с OZON